<script type="text/ng-template" id="tagTemplate.html">
    <a>
        <img src="/img/{{match.model.type}}.png" style="vertical-align: top;width:15px;"/> {{ match.model.value }}
        ({{match.model.count }})
    </a>
</script>
<div class="container-fluid">
    <div class="filters">
        <div class="row row-centered filter-row">
            <input
                    type="text"
                    placeholder="Search a creator / artist / title ..."
                    typeahead-template-url="tagTemplate.html"
                    typeahead-loading="loadingLocations"
                    typeahead="x.value for x in getTags($viewValue)"
                    ng-model="selectedTag"
                    typeahead-on-select="addTag($item)"
                    class="form-control col-centered" style="width:80%;"/>
            <i ng-show="loadingLocations" class="glyphicon glyphicon-refresh"></i>
        </div>
        <div class="row row-centered filter-row">
            <div class="btn-group col-xs-12 col-sm-12 col-md-12 col-lg-12 ">
                <div class="col-centered">
                    <div class="btn-group">
                        <label ng-model="d.active" ng-change="draw()" btn-checkbox class="btn btn-default"
                               ng-repeat="d in difficulties">
                            <img src="/img/mode/osu/{{converter.difficulty[d.value]}}.png"
                                 style="vertical-align: top;width:20px;"/>
                            {{d.name}}
                        </label>
                        <label ng-model="m.active" ng-change="draw()" btn-checkbox class="btn btn-default"
                               ng-repeat="m in modes">
                            <img src="/img/mode/{{converter.mode[m.value]}}/mode.png"
                                 style="vertical-align: top;width:20px;"/>
                            {{m.name}}
                        </label>
                    </div>
                </div>
            </div>
        </div>
        <div class="row row-centered filter-row">
            <div class="btn-group col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="col-centered">
                    <div class="btn-group">
                        <button class="tag btn btn-default" ng-repeat="tag in tags" ng-click="removeTag(tag.tagId)">
                            <img src="/img/{{tag.type}}.png" style="vertical-align: top;width:20px;"/>
                            {{ tag.value }}
                        </button>
                        <a type="button" class="btn btn-default" ng-if="tags.length > 0" target="_blank"
                           download="pack.zip" href="{{downloadAllLink}}">
                            <span class="glyphicon glyphicon-download"></span> Download all
                        </a>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
<table class="table table-striped row beatmapsetTable">
    <thead>
    <tr class="beatmapsetRow">
        <td class="beatmapsetCell">
        </td>
        <td class="beatmapsetCell sorting-column" ng-click="sort(sortings.artist)">
            <img src="/img/artist.png" style="width:20px;padding-right:5px;"> artist
        </td>
        <td class="beatmapsetCell sorting-column" ng-click="sort(sortings.title)">
            <img src="/img/title.png" style="width:20px;padding-right:5px;"> title
        </td>
        <td class="beatmapsetCell sorting-column" ng-click="sort(sortings.bpm)">
            bpm
        </td>
        <td class="beatmapsetCell">
            difficulties
        </td>
    </tr>
    </thead>
    <tbody>
    <tr ng-repeat="pack in packs" class="beatmapsetRow">
        <td class="beatmapsetCell">
            <div style="min-height:60px;">
                <img src="/media/{{pack.beatmapset_id}}/{{pack.beatmapset_id}}.jpg"
                     ng-mouseover="pack.isDisplayed = true" ng-mouseleave="pack.isDisplayed=false">


            </div>
        </td>
        <td class="beatmapsetCell"  >
            {{pack.artist}}
        </td>
        <td class="beatmapsetCell" >
            {{pack.title}}
        </td>
        <td class="beatmapsetCell">
            {{pack.bpm}}
        </td>
        <td class="beatmapsetCell">
            <img id="popover-{{beatmap.beatmap_id}}"
                 ng-repeat="beatmap in pack.beatmaps | orderBy:'difficultyrating'"
                 ng-click="showBeatmap(beatmap)"
                 src="/img/mode/{{converter.mode[beatmap.mode]}}/{{converter.difficulty[beatmap.difficulty]}}.png"
                 style="width:20px;margin-left:2px;"/>
        </td>
        <td>
            <div class="viewDetail" >
                <a type="button" class="btn btn-default" target="_blank"
                   href="https://osu.ppy.sh/s/{{pack.beatmapset_id}}">
                    <span class="glyphicon glyphicon-link" aria-hidden="true"></span>
                </a>
                <a type="button" class="btn btn-default" target="_self" href="{{pack.downloadLink}}"
                   download="{{pack.downloadName}}">
                    <span class="glyphicon glyphicon-download" aria-hidden="true"></span>
                </a>
                <a type="button" class="btn btn-default" ng-click="playBeatmap(pack.beatmapset_id)">
                    <span class="glyphicon glyphicon-play" aria-hidden="true"></span>
                </a>
            </div>
        </td>
    </tr>
    </tbody>
</table>

<audio id="player" src="" type="audio/mp3"></audio>


